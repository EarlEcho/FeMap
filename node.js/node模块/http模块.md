# HTTP æ¨¡å—

Nodejs ä½œä¸ºä¸€é—¨æœåŠ¡å™¨è¯­è¨€ï¼Œé‚£ä¹ˆ HTTP æ¨¡å—è‚¯å®šæ˜¯é‡ç‚¹å’¯ï¼

http æ¨¡å—ä¸­æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªç‚¹å¦‚ä¸‹ï¼š

1. æœåŠ¡å™¨å¯¹è±¡ - http.createServer();
2.

## æœåŠ¡å™¨å¯¹è±¡

è¿˜æ˜¯ä¸€æ ·ï¼Œå…ˆæ–°å»ºä¸€ä¸ª index.js æ–‡ä»¶ï¼Œå¹¶å¼•å…¥è¿™ä¸ª http æ¨¡å—

```js
let http = require('http');
// æˆ‘ä»¬è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡é¦–å…ˆè¦åˆ›å»ºå®ƒ æ‰€ä»¥è¦ä½¿ç”¨åˆ°http.createServer()è¿™ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°
http.createServer(() => {
  console.log('start');
});
```

ä½†æ˜¯å…‰è¿™æ ·å†™è‚¯å®šæ˜¯ä¸è¡Œå“’ï¼Œä¸ºå•¥å‘¢ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“æœåŠ¡æ˜¯éœ€è¦è¿è¡Œåœ¨æŸä¸ªå…·ä½“çš„ç«¯å£ä¸Šçš„ï¼Œæˆ‘ä»¬è¿™é‡Œéƒ½æ²¡æœ‰æŒ‡å®šç«¯å£ï¼Œå®ƒå¦‚ä½•è¿è¡Œèµ·æ¥å‘¢ï¼Ÿæ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸Šä¸€ä¸ªç«¯å£å·

```js
let http = require('http');
// æˆ‘ä»¬è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡é¦–å…ˆè¦åˆ›å»ºå®ƒ æ‰€ä»¥è¦ä½¿ç”¨åˆ°http.createServer()è¿™ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°
http
  .createServer(() => {
    console.log('start');
  })
  .listen(8888); // è¿è¡Œåœ¨8888ç«¯å£
```

é‚£è¿™æ ·çš„è¯ï¼Œå°±å¯ä»¥å¤§è‡´çœ‹å¾—åˆ°æ•ˆæœäº†ï¼Œæ§åˆ¶å°æ‰§è¡Œ `node index.js` è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå³å¯åŠ¨æœåŠ¡ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°å…‰æ ‡åœ¨é—ªçƒï¼Œè¯´æ˜æœåŠ¡è·‘èµ·æ¥äº†ï¼Œæ¥ä¸‹æ¥æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® localhost:8888ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢ä¸€ç›´åœ¨è½¬åœˆåœˆï¼Œä½†æ˜¯æ§åˆ¶å°å°±èƒ½çœ‹åˆ°æˆ‘ä»¬æ‰“å°å‡ºæ¥çš„`start`ã€‚è¯´æ˜è¿™ä¸ªæœåŠ¡ç®€å•çš„è·‘èµ·æ¥å•¦ï½

æ¥ä¸‹æ¥å°±è¦è¯¦ç»†è§£é‡Šè¿™ä¸ª createServer å•¦ï¼Œåˆšåˆšæˆ‘ä»¬çŸ¥é“äº† createServer å…è®¸æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè€Œå›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

1. request - è¯·æ±‚çš„å‚æ•°
2. response - è¿”å›çš„å‚æ•°

ä¸Šé¢çš„ä¾‹å­å¯ä»¥ä¿®æ”¹æˆè¿™ä¸ªäºšå­ï¼š

```js
let http = require('http');
http
  .createServer((req, res) => {
    res.write('index'); // è¿”å›ä¸€ä¸ªindex
    res.end(); // endå¿…é¡»æœ‰ è¡¨ç¤ºç°åœ¨è¯·æ±‚å®Œæˆäº†

    //  ä¸Šé¢ä¸¤å¥å¯ä»¥ç›´æ¥ç®€å†™æˆï¼š
    res.end('index1');
  })
  .listen(8888); // è¿è¡Œåœ¨8888ç«¯å£
```

åŸºç¡€çš„ä»‹ç»å®Œå•¦ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥å®Œæˆä¸€ä¸ªåŸºç¡€çš„å° ğŸŒ°ï¼Œåˆ©ç”¨ createServer è¿”å›ä¸€ä¸ªç°æœ‰çš„é¡µé¢(å³ä½¿ç”¨ node çš„ http æœåŠ¡è®¿é—®ä¸€ä¸ªé¡µé¢)
æ–°å»ºä¸€ä¸ª index.html æ–‡ä»¶ï¼Œé‡Œé¢éšä¾¿æ•²ç‚¹æ–‡å­—å†åŠ ä¸ªå›¾ã€‚
å…·ä½“å®ç°å¦‚ä¸‹ï¼š

```js
let http = require('http');
let fs = require('fs'); // ç”±äºè¦æ˜¾ç¤ºhtmlæ–‡ä»¶ï¼Œå³è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè‚¯å®šè¦ç”¨åˆ°æˆ‘ä»¬ä¹‹å‰å­¦åˆ°çš„fsæ¨¡å—å•¦

http
  .createServer((req, res) => {
    console.log(req.url); // è¯·æ±‚çš„urlåœ°å€
    fs.readFile(`./${req.url}`, (err, data) => {
      if (err) {
        console.error(err);
        res.wirteHead(404); // è¿”å›ä¸€ä¸ª404çš„çŠ¶æ€ç 
        res.end('404 not Found');
      } else {
        // res.wirteHead(200); // è¿”å›ä¸€ä¸ª200çš„çŠ¶æ€ç ï¼Œä½†æ˜¯ç”±äº200æ˜¯é»˜è®¤çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å¯å†™å¯ä¸å†™ã€‚
        res.end(data);
      }
    });
  })
  .listen(8888);
```
